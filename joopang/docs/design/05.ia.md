# Information Architecture — Joopang Platform

## 1. Guiding Principles
- **Persona-centric surfaces**: 고객/회원, 내부 운영자, 외부 연동 시스템을 각각 다른 IA 트랙으로 구성한다.
- **도메인 경계 준수**: 카탈로그, 장바구니, 주문, 결제, 쿠폰, 재고, 운영, 연동 등 PRD/FS 문서의 도메인 분리를 그대로 유지한다.
- **API 우선 탐색**: UI 대신 API/서비스 기준으로 정보 구조를 제공하며, 각 엔드포인트 묶음을 첫 진입점으로 제시한다.
- **Cross-cutting awareness**: 인증, 로캘, 관측성 등 공통 요소는 별도 허브에서 접근하도록 한다.

## 2. Top-level Navigation
| 섹션 | 대상 | 설명 | 핵심 하위 노드 |
| --- | --- | --- | --- |
| **Public API** | 게스트/회원 고객 | 상품 탐색부터 주문/결제까지 고객 플로우 지원 | Catalog, Cart, Orders, Payments, Coupons |
| **Internal Operations** | 상담사, 재고/마케팅/운영 관리자 | 재고 조정, 쿠폰 정책, 고객 지원, 모니터링 기능 | Inventory, Marketing, Support Desk, Operations |
| **Integrations** | 외부 데이터 플랫폼 | 아웃박스 이벤트 전송 및 재시도 | Event Outbox, Retry & Ack, Metrics |
| **Shared Services** | 전 조직 | 공통 인증/로캘/에러 처리/로그 | Auth & RBAC, Locale & Pricing, Error Handling, Observability |

## 3. Public API Structure
### 3.1 Catalog & Discovery
- `GET /products` (필터/정렬/페이지네이션)
- `GET /products/{id}` (상품 상세)
- `GET /products/top` (시장별 인기 상품)
- 데이터 캐시 상태 및 재고/가격 동기화 정보 반환

### 3.2 Cart
- `GET /carts/current` (세션/사용자 장바구니 조회)
- `PUT /carts/current/items` (항목 추가/수정)
- `DELETE /carts/current/items/{itemId}` (항목 삭제)
- `POST /carts/merge` (비회원→회원 전환)
- Cart pricing calculator (소계, 세금, 배송비, 예상 총액)

### 3.3 Orders & Payments
- `POST /orders` (멱등 키 기반 주문 생성, 재고 예약, 쿠폰 적용)
- `GET /orders`, `GET /orders/{id}` (주문 목록/상세)
- `POST /orders/{id}/cancel` (취소 및 복구)
- 결제/지갑
  - `GET /wallet/balance`, `GET /wallet/transactions`
  - `POST /wallet/pay`, `POST /wallet/refunds`
- 주문 상태 (`PENDING`, `PAID`, `FULFILLED`, `CANCELLED`, `REFUNDED`) 및 결제 결과 응답 구조

### 3.4 Coupons
- `POST /coupons/{templateId}/issue`
- `POST /coupons/validate`
- `GET /users/{userId}/coupons`
- 에러 코드 및 미적용 사유 메시지 구조

## 4. Internal Operations Structure
### 4.1 Inventory Management (재고 관리자)
- `POST /admin/inventory/adjustments` (입고/보정)
- `GET /admin/inventory/audits`
- 재고 감사 로그, 담당자/사유 기록, 이벤트 발행

### 4.2 Marketing & Coupons (마케팅 관리자)
- `POST /admin/coupons` / `PATCH /admin/coupons/{id}`
- `GET /admin/coupons/{id}/stats`, 발급/사용 현황
- 쿠폰 회수/비활성화, 캠페인 메타데이터 관리

### 4.3 Support Desk (고객 상담사)
- `GET /support/customers/{id}/orders`
- `POST /support/orders/{id}/refunds`
- 상담사 활동 로그, 민감 데이터 마스킹

### 4.4 Operations Control (운영 관리자)
- `GET /admin/metrics/core` (주문, 재고, 쿠폰 KPI)
- `GET /admin/integrations/outbox`
- `POST /admin/integrations/outbox/{id}/retry`
- 시스템 설정 변경, 감사 로그 및 승인 워크플로우

## 5. Integrations Structure
- **Event Outbox**
  - `GET /integrations/events/pull` (배치/롱폴링)
  - 이벤트 스키마: 주문, 쿠폰, 재고 변경
- **Acknowledgement & Retry**
  - `POST /integrations/events/ack`
  - `POST /integrations/events/retry`
- **Integration Monitoring**
  - 전송 상태, 실패율, 지연 메트릭
  - 재시도 큐 및 데드레터 확인

## 6. Shared Services & Cross-cutting Concerns
- **Auth & RBAC**
  - OAuth2/JWT 발급, 역할(`Guest`, `Customer`, `Support`, `Inventory`, `Marketing`, `Admin`, `External`)
  - 엔드포인트 보호 매트릭스
- **Locale & Pricing**
  - `Accept-Language`, `X-Market` 파싱
  - 통화 변환, 반올림 규칙, 지역별 세금 설정
- **Error Handling**
  - 공통 `ErrorResponse`, `ErrorCodes`, `traceId`, 재시도 헤더 정책
- **Observability**
  - 로그/트레이스/메트릭 수집, 알람 연동, 핵심 SLA 지표

## 7. Navigation Map (Summary)
```
Root
├─ Public API
│  ├─ Catalog
│  ├─ Cart
│  ├─ Orders & Payments
│  └─ Coupons
├─ Internal Operations
│  ├─ Inventory
│  ├─ Marketing
│  ├─ Support Desk
│  └─ Operations
├─ Integrations
│  ├─ Event Outbox
│  └─ Retry & Metrics
└─ Shared Services
   ├─ Auth & RBAC
   ├─ Locale & Pricing
   ├─ Error Handling
   └─ Observability
```
