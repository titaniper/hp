# Step 15-16 To-Do (spec.md 기반)

## 1. 트랜잭션 범위 진단

- [ ] 주문/예약/쿠폰 등 주요 유즈케이스의 트랜잭션 경계를 시퀀스 다이어그램으로 표현하고, DB 작업 vs 외부 연동을 구분한다.
- [ ] 트랜잭션 내 실행 시간이 긴 작업(외부 API, 대량 계산)을 목록화하고, 분리 우선순위를 결정한다.

## 2. 이벤트 기반 관심사 분리

- [ ] `@TransactionalEventListener(AFTER_COMMIT)`를 활용해 주문 완료 후 후속 작업(예: 알림, 데이터 전송)을 이벤트로 분리한다.
- [ ] 이벤트 발행/구독 클래스 위치와 네이밍 규칙을 컨벤션으로 문서화한다.
- [ ] 이벤트 리스너에서 실패 시 재시도/모니터링 전략(로그, Alert)을 정의한다.

## 3. 비동기/큐잉 구조 정비

- [ ] Redis Stream 또는 Queue를 통해 비동기로 처리할 작업(쿠폰 발급, 주문 전파 등)을 식별하고 설계안을 작성한다.
- [ ] 큐 적재 시 중복 방지 키 전략과 ETA 계산 방식(queue rank 기반)을 명시한다.
- [ ] PEL/Retry 모니터링 지표와 대시보드 요구사항을 정의한다.

## 4. Redis 기반 랭킹/캐시 전략

- [ ] 인기 상품 랭킹 키 구조(일/시간 단위)와 TTL/슬라이딩 윈도우 전략을 확정한다.
- [ ] 임시 키 없이 고정 키로 집계하는 절차 및 Warmup Job 동작을 점검한다.
- [ ] ZUNIONSTORE/파이프라인 성능 측정 스크립트를 작성해 보고서에 추가한다.

## 5. 트랜잭션 분리 후 보상/에러 전략

- [ ] 비동기로 전환된 작업의 실패 시나리오를 정의하고, 보상 트랜잭션 또는 재처리 절차를 설계한다.
- [ ] 트랜잭션 분리로 인해 데이터 일관성이 깨질 수 있는 지점을 찾아 모니터링/알림 조건을 정의한다.
- [ ] 이벤트 스키마 버전 관리 및 향후 Kafka 등 외부 브로커로 확장할 때의 메시지 규칙을 초안으로 작성한다.
