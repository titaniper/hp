# ðŸš€ ì„±ëŠ¥ ì§€í‘œ ë° ë¶€í•˜ í…ŒìŠ¤íŠ¸ (Performance Metrics & Load Testing)

## 1. í•µì‹¬ ì„±ëŠ¥ ì§€í‘œ

### 1.1 ì²˜ë¦¬ëŸ‰ ë° ì‘ë‹µ ì†ë„

- **TPS (Transaction Per Second)**: ì´ˆë‹¹ ì²˜ë¦¬ ê°€ëŠ¥í•œ íŠ¸ëžœìž­ì…˜ ìˆ˜. ì‹œìŠ¤í…œì˜ ì²˜ë¦¬ ìš©ëŸ‰.
- **RPS (Request Per Second)**: ì´ˆë‹¹ ìš”ì²­ ìˆ˜. (í•˜ë‚˜ì˜ íŠ¸ëžœìž­ì…˜ì´ ì—¬ëŸ¬ ìš”ì²­ì„ í¬í•¨í•  ìˆ˜ ìžˆìŒ)
- **Latency (ì‘ë‹µ ì‹œê°„)**: ìš”ì²­ì„ ë³´ë‚´ê³  ì‘ë‹µì„ ë°›ì„ ë•Œê¹Œì§€ ê±¸ë¦¬ëŠ” ì‹œê°„.

### 1.2 Percentile (ë°±ë¶„ìœ„ìˆ˜) ì§€í‘œ

í‰ê· (Average)ì˜ í•¨ì •ì„ í”¼í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•©ë‹ˆë‹¤.

- **p95**: ì „ì²´ ìš”ì²­ ì¤‘ ê°€ìž¥ ë¹ ë¥¸ 95%ì˜ ì‘ë‹µ ì‹œê°„ì´ ì´ ê°’ ì´ë‚´ìž„. (ìƒìœ„ 5% ëŠë¦° ìš”ì²­ ì œì™¸)
- **p99**: ì „ì²´ ìš”ì²­ ì¤‘ ê°€ìž¥ ë¹ ë¥¸ 99%ì˜ ì‘ë‹µ ì‹œê°„ì´ ì´ ê°’ ì´ë‚´ìž„. (ìƒìœ„ 1% ëŠë¦° ìš”ì²­ ì œì™¸)
- **ì˜ë¯¸**: íŠ€ëŠ” ê°’(Outlier)ì— ì˜í–¥ì„ ëœ ë°›ìœ¼ë©°, ëŒ€ë‹¤ìˆ˜ ì‚¬ìš©ìžê°€ ê²ªëŠ” ì‹¤ì œ ì„±ëŠ¥ì„ ëŒ€ë³€í•¨.

---

## 2. ë¶€í•˜ í…ŒìŠ¤íŠ¸ ìœ í˜•

```mermaid
xychart-beta
    title ë¶€í•˜ í…ŒìŠ¤íŠ¸ íŒ¨í„´ ë¹„êµ
    x-axis [ì‹œê°„]
    y-axis "ë¶€í•˜ëŸ‰ (VUser)" 0 --> 100
    
    line [0, 20, 40, 60, 80, 100, 100, 100] text "Stress Test (í•œê³„ì  íŒŒì•…)"
    line [0, 50, 50, 50, 50, 50, 50, 0] text "Load Test (í‰ì†Œ ë¶€í•˜)"
    line [0, 10, 100, 10, 10, 100, 10, 0] text "Peak Test (ìˆœê°„ í­ì£¼)"
```

1. **Load Test (ë¶€í•˜ í…ŒìŠ¤íŠ¸)**: ëª©í‘œ ì‹œìŠ¤í…œì´ ì˜ˆìƒ ë¶€í•˜ë¥¼ ê°ë‹¹í•  ìˆ˜ ìžˆëŠ”ì§€ ê²€ì¦. (í‰ì†Œ íŠ¸ëž˜í”½)
2. **Stress Test (ìŠ¤íŠ¸ë ˆìŠ¤ í…ŒìŠ¤íŠ¸)**: ë¶€í•˜ë¥¼ ì ì§„ì ìœ¼ë¡œ ë†’ì—¬ ì‹œìŠ¤í…œì˜ **í•œê³„ì (Breaking Point)**ì„ ì°¾ìŒ.
3. **Peak Test (í”¼í¬ í…ŒìŠ¤íŠ¸)**: ì´ë²¤íŠ¸ ìƒí™© ë“± ìˆœê°„ì ìœ¼ë¡œ ëª°ë¦¬ëŠ” íŠ¸ëž˜í”½ì— ëŒ€í•œ ë‚´ì„± ê²€ì¦.
4. **Endurance Test (ë‚´êµ¬ì„± í…ŒìŠ¤íŠ¸)**: ì˜¤ëžœ ì‹œê°„(ì˜ˆ: 24ì‹œê°„) ë¶€í•˜ë¥¼ ì£¼ì–´ **ë©”ëª¨ë¦¬ ëˆ„ìˆ˜(Memory Leak)** ë“±ì„ ë°œê²¬.

---

## 3. ì£¼ìš” ì„±ëŠ¥ ì´ìŠˆ ë° ë³‘ëª©

### 3.1 DB ê´€ë ¨

- **Slow Query**: ì¸ë±ìŠ¤ ë¯¸ì ìš©, ë¹„íš¨ìœ¨ì  ì¡°ì¸ ë“±ìœ¼ë¡œ ì‹¤í–‰ ì‹œê°„ì´ ì˜¤ëž˜ ê±¸ë¦¬ëŠ” ì¿¼ë¦¬.
- **Connection Pool ê³ ê°ˆ**: DB ì—°ê²°ì„ ë°˜í™˜í•˜ì§€ ì•Šê±°ë‚˜ íŠ¸ëžœìž­ì…˜ì´ ë„ˆë¬´ ê¸¸ì–´ ì‚¬ìš© ê°€ëŠ¥í•œ ì»¤ë„¥ì…˜ì´ ì—†ëŠ” ìƒíƒœ.
- **Deadlock (êµì°© ìƒíƒœ)**: ë‘ íŠ¸ëžœìž­ì…˜ì´ ì„œë¡œì˜ ìžì›ì„ ê¸°ë‹¤ë¦¬ë©° ë¬´í•œ ëŒ€ê¸°í•˜ëŠ” ìƒíƒœ.

### 3.2 ì• í”Œë¦¬ì¼€ì´ì…˜ ê´€ë ¨

- **OOM (Out Of Memory)**: íž™ ë©”ëª¨ë¦¬ ë¶€ì¡±ìœ¼ë¡œ JVMì´ ì¢…ë£Œë¨. ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ë‚˜ ê³¼ë„í•œ ê°ì²´ ìƒì„±ì´ ì›ì¸.
- **GC Pause (Stop-the-world)**: Garbage Collection ìˆ˜í–‰ì„ ìœ„í•´ ì• í”Œë¦¬ì¼€ì´ì…˜ ìŠ¤ë ˆë“œê°€ ë©ˆì¶”ëŠ” í˜„ìƒ. ì‘ë‹µ ì§€ì—°ì˜ ì£¼ì›ì¸.

---

## 4. ë¶€í•˜ í…ŒìŠ¤íŠ¸ ë„êµ¬ (k6)

### 4.1 k6 íŠ¹ì§•

- Go ì–¸ì–´ë¡œ ìž‘ì„±ë˜ì–´ ì„±ëŠ¥ì´ ë›°ì–´ë‚¨.
- JavaScript(ES6)ë¡œ í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤ ìž‘ì„± ê°€ëŠ¥.
- ê°œë°œìž ì¹œí™”ì ì´ë©° CI/CD íŒŒì´í”„ë¼ì¸ í†µí•© ìš©ì´.

### 4.2 k6 ìŠ¤í¬ë¦½íŠ¸ ì˜ˆì‹œ

```javascript
import http from 'k6/http';
import { check, sleep } from 'k6';

export const options = {
  stages: [
    { duration: '30s', target: 20 }, // Ramp-up: 30ì´ˆ ë™ì•ˆ ìœ ì € 20ëª…ê¹Œì§€ ì¦ê°€
    { duration: '1m', target: 20 },  // Steady: 1ë¶„ê°„ ìœ ì§€
    { duration: '10s', target: 0 },  // Ramp-down: 10ì´ˆ ë™ì•ˆ ì¢…ë£Œ
  ],
};

export default function () {
  const res = http.get('http://localhost:8080/api/products');
  
  check(res, {
    'status is 200': (r) => r.status === 200,
    'latency < 200ms': (r) => r.timings.duration < 200,
  });
  
  sleep(1); // 1ì´ˆ ëŒ€ê¸° (Think Time)
}
```
